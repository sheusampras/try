<html>
<head>
    <title>Live2D！把可爱的看板娘扑捉到你的博客去吧！</title>
     <script type="text/javascript">
    var v_str="?v=1.0.6";
    var nowType="style0";
    var btn_nums=24;
    var live2DWidth=640;
    var live2DHeight=1000;
    var chestTouchFunc=function(e){};
    var bodyTouchFunc=function(e){};
        //使用jquery
        $(document).ready(function()
        {   

            //預先讀圖,防止hover才載圖
            for(var i=1;i<=btn_nums;i++)
            {
              $.preload
              ( 
                  'images/'+nowType+'/btn'+i+'-2.png',
                  'images/'+nowType+'/btn'+i+'-3.png',
              );
            }
            $('.myBtn').myBtn(v_str);
            var live2D;
            var live2DJSON= 
            {
              canvasId:'id_live2D_canvas', // canvas的id
              baseUrl: './live2D/Ball', // 资源原始路径
              modelUrl: './live2D/Ball/Ball.model.json', // 自定义model.json路径 方便用于一键换装
              crossOrigin: false, // 是否允许跨域获取数据(前提是http header中已有允许的跨域字段) def:false
              interval: 1, // 自动mation的开始时间点到下一个mation的开始点之间的间隔
              idle: 'idle', // 自动触发的mation
              width: live2DWidth, // html上的width属性优先级更高
              height: live2DHeight,// html上的height属性优先级更高
              globalollowPointer: false, // 全局跟随鼠标 def:false
              scaling: false, // 是否允许使用滚轮放大缩小 def:false
              debug: 
              {
                DEBUG_LOG: false,
                DEBUG_MOUSE_LOG : false,
              },
              layout: { // 布局设置 这个优先级最高，然后到model.json(字段正确的话)，再到默认
                width: '',
                height: '',
                x: '',
                y: '',
                center_x: '',
                center_y: '',
                top: '',
                bottom: '',
                left: '',
                right: ''
              },
              view: {
                VIEW_MAX_SCALE: 2, // 最大缩放比例
                VIEW_MIN_SCALE: 0.8, // 最小缩放比例
                VIEW_LOGICAL_LEFT: -1,
                VIEW_LOGICAL_RIGHT: 1,
                VIEW_LOGICAL_MAX_LEFT: -2,
                VIEW_LOGICAL_MAX_RIGHT: 2,
                VIEW_LOGICAL_MAX_BOTTOM: -2,
                VIEW_LOGICAL_MAX_TOP: 2
              },
              binding:
              { // 需要自行根据不同模型的model.json将mation绑定到对应的hit_areas 支持hit_areas_custom

                body: function()
                {

                  live2D.startMotion("Ball_1_front_unhappy_shakeHead",0, 3);
                },
                body_chest: function()
                {
                  //console.log(this);
                 live2D.startMotion("Ball_1_front_unhappy_roar",0, 3);
                  
                }
              },
              autoLoadAudio:function()
              {
                //console.log('audio loaded');
              }, // 自动下载音频 def：true
              initModelCallback(waifu)
              {
                //console.log(waifu);
                //console.log('加载完毕');
                isModleFinish=true;
                live2DProgress=1;//確定讀完
                $("#id_loading_img").hide();
              }
            };

            live2D=loadLive2d(live2DJSON);

            
            var cheatToogle=false;
            function change()
            {

              //
             // $( "#id_live2D_canvas" ).toggle( "bounce", { times: 20 } ,20,function()
              //{
               // $( "#id_live2D_canvas" ).effect( "pulsate" ,{ times: 5 } ,10,function()
                 // {
                  //  $( "#id_live2D_canvas" ).toggle( "clip",function()
                     // {
                      $("#id_loading_img").fadeIn();
                      $( "#id_live2D_canvas" ).fadeOut("slow",function()
                      {
                         if(cheatToogle)
                         {
                           cheatToogle=false;
                           live2DJSON.baseUrl="./live2D/Ball";        
                           live2DJSON.modelUrl="./live2D/Ball/Ball.model.json";
                           
                         }
                         else
                         {
                           cheatToogle=true;
                           live2DJSON.baseUrl="./live2D/Ball_comic";        
                           live2DJSON.modelUrl="./live2D/Ball_comic/Ball.model.json";
                          }
                         var tmpFunc=function()
                         {
                          //$("#id_live2D_canvas").toggle("clip");
                          $("#id_live2D_canvas").fadeIn();
                          $("#id_loading_img").fadeOut();
                         }
                        live2DJSON.initModelCallback=tmpFunc;
                         live2D=loadLive2d(live2DJSON);
                       });
                    //   });
                    //});
               //});
            }
            $("#id_btn_change_img").click(function(e) 
            {
                  change();
                
            });//end click

            var live2DCanvas = document.getElementById("id_live2D_canvas");
            var canvasSizeModified=1.15;
            function makeResponsive() 
            {    
  
                window.addEventListener('resize', resizeCanvas);        
                resizeCanvas();     
                function resizeCanvas() 
                {           
                    var w = live2DWidth, h = live2DHeight;            
                  
                    var ih=$(window).height();//這邊是依照高度做等比例縮放
                    var pRatio = window.devicePixelRatio || 1, yRatio=ih/h,sRatio=1;          

                    if(h>ih)
                    {               
                        sRatio = yRatio;             
                    }
                              
                    live2DCanvas.width = w*pRatio*sRatio*canvasSizeModified;         
                    live2DCanvas.height = h*pRatio*sRatio*canvasSizeModified;
                    live2DCanvas.style.width =  w*sRatio*canvasSizeModified+'px';               
                    live2DCanvas.style.height = h*sRatio*canvasSizeModified+'px';
                    changeScale=sRatio*canvasSizeModified;//為了live2D點擊位置判斷用
                }
            }
            makeResponsive();  


            var mySwiper1Option=              
            {
                // Optional parameters
                direction: 'horizontal',
                initialSlide:0,//一開始的index位置
                loop: true,
                // autoplay: 
                // {
                //   delay: 1000,
                //   disableOnInteraction: false
                // },
                slidesPerView:getSlide() ,
                grabCursor: false,
                preloadImages:true,
                updateOnImagesReady:true,
                spaceBetween:getSpace(),
                navigation: 
                {
                  nextEl: '#id_slider_right',
                  prevEl: '#id_slider_left'
                },
                // effect:"coverflow",
                cubeEffect://cube ie無法使用  
                {
                  slideShadows: false,
                  shadow:true,
                  shadowScale:1,
                  shadowOffset:-50
                },
                coverflowEffect: 
                {
                  rotate:-15,
                  stretch: 0,
                  depth: 70,
                  modifier: 1,
                  slideShadows: false
                },
                fadeEffect: 
                {
                  crossFade: true
                },
                flipEffect: 
                {
                   rotate: 30,
                   slideShadows: false
                }
              }
            var mySwiper1 = new Swiper ('#id_slider_swiper-container', 
            mySwiper1Option);

            $(".btnLive2D").click(function(e) 
            {
            
                //alert($(this).attr('id'));
                var idName=$(this).attr('id');
                var tmpStr=idName.split("id_btn_")[1];
                var actionName=tmpStr.substring(0,tmpStr.length-2);
                var actionIndex=tmpStr.substring(tmpStr.length-1,tmpStr.length)

                //alert(actionName);
                //alert(actionIndex);
                live2D.startMotion(actionName,actionIndex, 3);

            });//end click



            //判斷螢幕寬度決定角色一次顯示的個數
            var change_width=474;
            function getSlide() 
            {
                var wW = $(window).width();
                
                var return_value=7;

                  if(wW<change_width)
                  {
                    return_value=5;
                  }
                  else
                  {
                    return_value=7;
                  }
                
   
                return return_value;
            }
            function getSpace() 
            {
                var wW = $(window).width();
                var return_value=0;

                  if(wW<change_width)
                  {
                    return_value=10;
                  }
                  else
                  {
                    return_value=0;
                  }
                
            
                return return_value;
            }
            //視窗有變化時
            $(window).resize(function() 
            {
              mySwiper1.params.slidesPerView=getSlide() ;
              mySwiper1.params.spaceBetween=getSpace() ;
              mySwiper1.update();
            });//end 視窗有變化時
            mySwiper1.params.slidesPerView=getSlide() ;
            mySwiper1.params.spaceBetween=getSpace() ;
            mySwiper1.update();
        });//end jquery ready(未載圖就執行)

        //載完所有html再執行
        $(window).on('load', function ()
        {
           
        });//end 載完所有html再執行


    </script>
</head>
<body>
<div>
    <canvas id="live2dcanvas" width="200" height="350"></canvas>
</div>
<style>
    #live2dcanvas {
          position: fixed;
        width: 200px;
        height: 350px;
        right: 0px;
        z-index: 999;
        pointer-events: none;
        bottom: -20px;
    }
</style>
<script type="text/javascript" src="device.min.js"></script>
<script type="text/javascript">
    const loadScript = function loadScript(c, b) {
        var a = document.createElement("script");
        a.type = "text/javascript";
        "undefined" != typeof b && (a.readyState ? a.onreadystatechange = function () {
            if ("loaded" == a.readyState || "complete" == a.readyState) a.onreadystatechange = null, b()
        } : a.onload = function () {
            b()
        });
        a.src = c;
        document.body.appendChild(a)
    };
    (function () {
        if ((typeof(device) != 'undefined') && (device.mobile())) {
            document.getElementById("live2dcanvas").style.width = '100px';
            document.getElementById("live2dcanvas").style.height = '175px';
        } else if (typeof(device) === 'undefined') console.error('Cannot find current-device script.');
        loadScript("script.js", function () {
            loadlive2d("live2dcanvas", "model.json", 0.5);
        });
    })();
</script>  
</body>
</html>
